function Use-ExistingAccessTokenString {
    Param(
        [Parameter(Mandatory = $True)]
        $AccessTokenString            
    )

    #Example
    #$AccessToken = 'eyJ0eXAiOiJKV1QiLCJub25jZSI6IjB5ZFdqVVZ0MjVZVnhweWlQb09lVU4zcXhBWU9XTVJ5c3ppRlNvbkRSZ3ciLCJhbGciOiJSUzI1NiIsIng1dCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyIsImtpZCI6Ii1LSTNROW5OUjdiUm9meG1lWm9YcWJIWkdldyJ9.eyJhdWQiOiJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8wNGY3NjFhOC1iMDBhLTRiOTAtYWM0MS0yYzU0YzEyMWZjYzgvIiwiaWF0IjoxNjgwMTg0MTQ3LCJuYmYiOjE2ODAxODQxNDcsImV4cCI6MTY4MDE4ODU1NiwiYWNjdCI6MCwiYWNyIjoiMSIsImFpbyI6IkUyWUFncU5ma3E3elRIdy9lMHJ6L2htMkc0WFphaVpJMUI4SWw3RFVtS2EvNFA3a0tnQT0iLCJhbXIiOlsicHdkIl0sImFwcF9kaXNwbGF5bmFtZSI6IldpbSBaaWpuIEVuZ2UgQXBwIiwiYXBwaWQiOiIxNDBhNzg4Zi0yMmIzLTRjNjAtOThiYi05ZmM4YWY4NDhjNzkiLCJhcHBpZGFjciI6IjEiLCJmYW1pbHlfbmFtZSI6IlZhbmNlIiwiZ2l2ZW5fbmFtZSI6IkFkZWxlIiwiaWR0eXAiOiJ1c2VyIiwiaXBhZGRyIjoiODkuMjA1LjEzOC4xNDIiLCJuYW1lIjoiQWRlbGUgVmFuY2UiLCJvaWQiOiI0MTEzOGM3MC0yYmVlLTQ5ZjctODFjYy1jNzQ4N2VjNzJkYTgiLCJwbGF0ZiI6IjMiLCJwdWlkIjoiMTAwMzIwMDIxRTI4QUY3QyIsInJoIjoiMC5BWGtBcUdIM0JBcXdrRXVzUVN4VXdTSDh5QU1BQUFBQUFBQUF3QUFBQUFBQUFBQ1VBSjAuIiwic2NwIjoiTWFpbC5SZWFkIHByb2ZpbGUgb3BlbmlkIGVtYWlsIiwic2lnbmluX3N0YXRlIjpbImttc2kiXSwic3ViIjoiRVFNcXFTVGYwUlY5Y0VKRnZsdXYxTHQtZ0xJcjlaenpHZEVGTFVYM1JTQSIsInRlbmFudF9yZWdpb25fc2NvcGUiOiJFVSIsInRpZCI6IjA0Zjc2MWE4LWIwMGEtNGI5MC1hYzQxLTJjNTRjMTIxZmNjOCIsInVuaXF1ZV9uYW1lIjoiQWRlbGVWQG91dHNpZGVydHJhaW5pbmcub25taWNyb3NvZnQuY29tIiwidXBuIjoiQWRlbGVWQG91dHNpZGVydHJhaW5pbmcub25taWNyb3NvZnQuY29tIiwidXRpIjoiTk05aTNVR3p6VVNsZVRnSjBFcEJBQSIsInZlciI6IjEuMCIsIndpZHMiOlsiYjc5ZmJmNGQtM2VmOS00Njg5LTgxNDMtNzZiMTk0ZTg1NTA5Il0sInhtc19zdCI6eyJzdWIiOiJTbXptLVFpd1dQck9HZVVNSHFYQlZJVXhlSG43end0VVVlalVXYTk4YklBIn0sInhtc190Y2R0IjoxNjYwNjcxODU5LCJ4bXNfdGRiciI6IkVVIn0.Ebxy_KNvCSwGdXIAEVoUmprhcsVGLAHoavhG7UVyvlfdV8Nb9a2NIrUxW7P3zC-C6xMxIwx9Z_BAYlQhiH8hfoLvdov3dczLCPnY_HDVu1Qz520r_yFQkhXK_UDjx2J5BybkYJNfHM5wTTEhMvbAajb2GtamPecTp1n-ZHrtt7CdZglkMo57EFacC9QDbSS_UrD_6tovgV7OtM_CdiwdayndIM_sIkr_hYQzhkMydhjo1h6r59TX14VbrllAZvsofQorWmz0aXbzi0N0pPKfn81J8QFc6zrBTvQRP_cGvNad9xWi6wye-8Rsnx6w-nl_X0ElTZsTHsAqdk5OELMJDQ'
    Use-ExistingAccessTokenString -AccessTokenString $AccessToken

    $global:AccessToken = $AccessTokenString
    $AccessTokenDetail = Get-AccessTokenDetail
    $global:TenantId = $AccessTokenDetail.tid
    $global:ClientId = $AccessTokenDetail.appid    
}